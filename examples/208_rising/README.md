based on <http://basilisk.fr/src/test/rising.c>
